var Oe=Object.defineProperty,Fe=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var Be=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var ie=(e,n,s)=>n in e?Oe(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,m=(e,n)=>{for(var s in n||(n={}))Be.call(n,s)&&ie(e,s,n[s]);if(re)for(var s of re(n))we.call(n,s)&&ie(e,s,n[s]);return e},N=(e,n)=>Fe(e,ke(n));var U=(e,n,s)=>new Promise((r,l)=>{var i=d=>{try{o(s.next(d))}catch(u){l(u)}},t=d=>{try{o(s.throw(d))}catch(u){l(u)}},o=d=>d.done?r(d.value):Promise.resolve(d.value).then(i,t);o((s=s.apply(e,n)).next())});import{a as ne,W as Pe,t as me,l as De,K as Te,q as Ee,p as Re,X as Ne,_ as V,i as q,A as We,C as he,z as ye,w as Ce}from"./index.js";import{g as X,s as _e,r as oe,h as K,u as a,d as E,I as be,k as y,i as Me,f as h,c as H,w as Se,o as Le,b as ve,y as W,Z as F,n as je,_ as k,$ as T,a0 as b,m as Ae,a2 as Z,a5 as Ie,af as _,F as ze,ai as Q,a4 as qe,G as x,a9 as ee,a3 as L,z as Ve,ae as ce,a8 as ue,ag as de,ah as pe,J as Y}from"./vue-Bks1hA2_.js";import{e as Xe,S as Ke,b as Ue,g as Ye,C as Ze}from"./index-BFMIjF4C.js";import{M as Ge,X as Je,ar as Qe,as as xe,ak as et,o as J,b as tt,ax as fe,A as nt}from"./antd-B38FcySN.js";import{u as le}from"./useDesign-DNtIzjv4.js";import{getDescSchema as ot}from"./data-BqNcCA2x.js";const{t:ge}=ne(),lt={open:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:ge("common.cancelText")},okText:{type:String,default:ge("common.okText")},closeFunc:Function},ae=Object.assign({},lt,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},open:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}}),at=["class","style"],st=/^on[A-Z]/;function rt(e){return Object.keys(e).map(n=>[n,e[n]])}function He(e={}){const n=X();if(!n)return{};const{excludeListeners:s=!1,excludeKeys:r=[],excludeDefaultKeys:l=!0}=e,i=_e({}),t=r.concat(l?at:[]);return n.attrs=oe(n.attrs),K(()=>{const o=rt(n.attrs).reduce((d,[u,p])=>(!t.includes(u)&&!(s&&st.test(u))&&(d[u]=p),d),{});i.value=o}),i}function it(e,n={}){const{wait:s=150,immediate:r}=n;let l=()=>{e()};l=De(l,s);const t=()=>{r&&l(),window.addEventListener("resize",l)},o=()=>{window.removeEventListener("resize",l)};return Pe(()=>{t()}),me(()=>{o()}),{start:t,stop:o}}function ct(e){const n=(l,i)=>getComputedStyle(l)[i],s=l=>{if(!l)return;l.setAttribute("data-drag",a(e.draggable));const i=l.querySelector(".ant-modal-header"),t=l.querySelector(".ant-modal");!i||!t||!a(e.draggable)||(i.style.cursor="move",i.onmousedown=o=>{if(!o)return;const d=o.clientX,u=o.clientY,p=document.body.clientWidth,f=document.documentElement.clientHeight,M=t.offsetWidth,B=t.offsetHeight,O=t.offsetLeft,w=p-t.offsetLeft-M,D=t.offsetTop,g=f-t.offsetTop-B,$=n(t,"left"),C=n(t,"top");let S=+$,P=+C;$.includes("%")?(S=+document.body.clientWidth*(+$.replace(/%/g,"")/100),P=+document.body.clientHeight*(+C.replace(/%/g,"")/100)):(S=+$.replace(/px/g,""),P=+C.replace(/px/g,"")),document.onmousemove=function(j){let c=j.clientX-d,v=j.clientY-u;-c>O?c=-O:c>w&&(c=w),-v>D?v=-D:v>g&&(v=g),t.style.cssText+=`;left:${c+S}px;top:${v+P}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},r=()=>{const l=document.querySelectorAll(".ant-modal-wrap");for(const i of Array.from(l)){if(!i)continue;const t=n(i,"display"),o=i.getAttribute("data-drag");t!=="none"&&(o===null||a(e.destroyOnClose))&&s(i)}};K(()=>{!a(e.open)||!a(e.draggable)||Te(()=>{r()},30)})}function ut(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Me(e)}const dt=E({name:"Modal",inheritAttrs:!1,props:ae,emits:["cancel"],setup(e,{slots:n,emit:s}){const{open:r,draggable:l,destroyOnClose:i}=be(e),t=He();ct({open:r,destroyOnClose:i,draggable:l});const o=d=>{s("cancel",d)};return()=>{let d;const u=N(m(m({},a(t)),e),{onCancel:o});return y(Ge,u,ut(d=Xe(n))?d:{default:()=>[d]})}}}),$e=Symbol();function pt(e){return Re(e,$e)}function Vt(){return Ee($e)}const ft={loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},open:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},gt=E({name:"ModalWrapper",components:{ScrollContainer:Ke},inheritAttrs:!1,props:ft,emits:["height-change","ext-height"],setup(e,{emit:n}){const s=h(null),r=h(null),l=h(0),i=h(0),t=h(0);it(u.bind(null)),Ne(r,()=>{u()},{attributes:!0,subtree:!0}),pt({redoModalHeight:u});const o=H(()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${a(l)}px`}));K(()=>{e.useWrapper&&u()}),Se(()=>e.fullScreen,p=>{u(),p?i.value=l.value:l.value=i.value}),Le(()=>{const{modalHeaderHeight:p,modalFooterHeight:f}=e;n("ext-height",p+f)}),ve(()=>{});function d(){return U(this,null,function*(){W(()=>{var f;const p=a(s);p&&((f=p==null?void 0:p.scrollTo)==null||f.call(p,0))})})}function u(){return U(this,null,function*(){if(!e.open)return;const p=a(s);if(!p)return;const f=p.$el.parentElement;if(f){f.style.padding="0",yield W();try{const M=f.parentElement&&f.parentElement.parentElement;if(!M)return;const B=getComputedStyle(M).top,O=Number.parseInt(B);let w=window.innerHeight-O*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;O<40&&(w-=26),yield W();const D=a(r);if(!D)return;yield W(),t.value=D.scrollHeight,e.fullScreen?l.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:l.value=e.height?e.height:t.value>w?w:t.value,n("height-change",a(l))}catch(M){}}})}return{wrapperRef:s,spinRef:r,spinStyle:o,scrollTop:d,setModalHeight:u,realHeight:t}}}),mt=["loading-tip"];function ht(e,n,s,r,l,i){const t=F("ScrollContainer"),o=je("loading");return k(),T(t,{ref:"wrapperRef",scrollHeight:e.realHeight},{default:b(()=>[Ae((k(),Z("div",{ref:"spinRef",style:Ie(e.spinStyle),"loading-tip":e.loadingTip},[_(e.$slots,"default")],12,mt)),[[o,e.loading]])]),_:3},8,["scrollHeight"])}const yt=V(gt,[["render",ht]]),Ct=E({name:"ModalClose",components:{Tooltip:Je,FullscreenExitOutlined:Qe,FullscreenOutlined:xe,CloseOutlined:et},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(e,{emit:n}){const{prefixCls:s}=le("basic-modal-close"),{t:r}=ne(),l=H(()=>[s,`${s}--custom`,{[`${s}--can-full`]:e.canFullscreen}]);function i(o){n("cancel",o)}function t(o){o==null||o.stopPropagation(),o==null||o.preventDefault(),n("fullscreen")}return{t:r,getClass:l,prefixCls:s,handleCancel:i,handleFullScreen:t}}});function bt(e,n,s,r,l,i){const t=F("FullscreenExitOutlined"),o=F("Tooltip"),d=F("FullscreenOutlined"),u=F("CloseOutlined");return k(),Z("div",{class:qe(e.getClass)},[e.canFullscreen?(k(),Z(ze,{key:0},[e.fullScreen?(k(),T(o,{key:0,title:e.t("component.modal.restore"),placement:"bottom"},{default:b(()=>[y(t,{role:"full",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"])):(k(),T(o,{key:1,title:e.t("component.modal.maximize"),placement:"bottom"},{default:b(()=>[y(d,{role:"close",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"]))],64)):Q("",!0),y(o,{title:e.t("component.modal.close"),placement:"bottom"},{default:b(()=>[y(u,{onClick:e.handleCancel},null,8,["onClick"])]),_:1},8,["title"])],2)}const Mt=V(Ct,[["render",bt]]),St=E({name:"BasicModalFooter",props:ae,emits:["ok","cancel"],setup(e,{emit:n}){function s(l){n("ok",l)}function r(l){n("cancel",l)}return{handleOk:s,handleCancel:r}}});function vt(e,n,s,r,l,i){const t=F("a-button");return k(),Z("div",null,[_(e.$slots,"insertFooter"),e.showCancelBtn?(k(),T(t,L({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:b(()=>[x(ee(e.cancelText),1)]),_:1},16,["onClick"])):Q("",!0),_(e.$slots,"centerFooter"),e.showOkBtn?(k(),T(t,L({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:b(()=>[x(ee(e.okText),1)]),_:1},16,["type","onClick","loading"])):Q("",!0),_(e.$slots,"appendFooter")])}const Ht=V(St,[["render",vt]]),$t=E({name:"BasicModalHeader",components:{BasicTitle:Ue},props:{helpMessage:{type:[String,Array]},title:{type:String}}});function Ot(e,n,s,r,l,i){const t=F("BasicTitle");return k(),T(t,{helpMessage:e.helpMessage},{default:b(()=>[x(ee(e.title),1)]),_:1},8,["helpMessage"])}const Ft=V($t,[["render",Ot]]);function kt(e){const n=h(!1),s=H(()=>{const l=a(e.wrapClassName)||"";return a(n)?`fullscreen-modal ${l} `:a(l)});function r(l){l&&l.stopPropagation(),n.value=!a(n)}return{getWrapClassName:s,handleFullScreen:r,fullScreenRef:n}}const Bt=E({name:"BasicModal",components:{Modal:dt,ModalWrapper:yt,ModalClose:Mt,ModalFooter:Ht,ModalHeader:Ft},inheritAttrs:!1,props:ae,emits:["open-change","height-change","cancel","ok","register","update:open"],setup(e,{emit:n,attrs:s}){const r=h(!1),l=h(null),i=h(null),{prefixCls:t}=le("basic-modal"),o=h(0),d={setModalProps:$,emitOpen:void 0,redoModalHeight:()=>{W(()=>{a(i)&&a(i).setModalHeight()})}},u=X();u&&n("register",d,u.uid);const p=H(()=>m(m({},e),a(l))),{handleFullScreen:f,getWrapClassName:M,fullScreenRef:B}=kt({modalWrapperRef:i,extHeightRef:o,wrapClassName:Ve(p.value,"wrapClassName")}),O=H(()=>{const c=N(m({},a(p)),{open:a(r),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return N(m({},c),{wrapClassName:a(M)})}),w=H(()=>{const c=N(m(m({},s),a(p)),{open:a(r)});return c.wrapClassName=`${(c==null?void 0:c.wrapClassName)||""} ${a(M)}denny-basic-modal-wrap`,a(B)?J(c,["height","title"]):J(c,"title")}),D=H(()=>{if(!a(B))return a(O).height});K(()=>{r.value=!!e.open,B.value=!!e.defaultFullscreen}),Se(()=>a(r),c=>{var v;n("open-change",c),n("update:open",c),u&&((v=d.emitOpen)==null||v.call(d,c,u.uid)),W(()=>{e.scrollTop&&c&&a(i)&&a(i).scrollTop()})},{immediate:!1});function g(c){return U(this,null,function*(){var v,I;if(c==null||c.stopPropagation(),!((I=(v=c.target)==null?void 0:v.classList)!=null&&I.contains(t+"-close--custom"))){if(e.closeFunc&&q(e.closeFunc)){const G=yield e.closeFunc();r.value=!G;return}r.value=!1,n("cancel",c)}})}function $(c){l.value=We(a(l)||{},c),Reflect.has(c,"open")&&(r.value=!!c.open),Reflect.has(c,"defaultFullscreen")&&(B.value=!!c.defaultFullscreen)}function C(c){n("ok",c)}function S(c){n("height-change",c)}function P(c){o.value=c}function j(c){e.canFullscreen&&(c.stopPropagation(),f(c))}return{handleCancel:g,getBindValue:w,getProps:O,handleFullScreen:f,fullScreenRef:B,getMergeProps:p,handleOk:C,openRef:r,omit:J,modalWrapperRef:i,handleExtHeight:P,handleHeightChange:S,handleTitleDbClick:j,getWrapperHeight:D}}});function wt(e,n,s,r,l,i){const t=F("ModalClose"),o=F("ModalHeader"),d=F("ModalFooter"),u=F("ModalWrapper"),p=F("Modal");return k(),T(p,L(e.getBindValue,{onCancel:e.handleCancel}),ce({default:b(()=>[y(u,L({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,open:e.openRef,modalFooterHeight:e.footer!==void 0&&!e.footer?0:void 0},e.omit(e.getProps.wrapperProps,"open","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:b(()=>[_(e.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","open","modalFooterHeight","onExtHeight","onHeightChange"])]),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:b(()=>[y(t,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])]),key:"0"},e.$slots.title?void 0:{name:"title",fn:b(()=>[y(o,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])]),key:"1"},e.$slots.footer?void 0:{name:"footer",fn:b(()=>[y(d,L(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),ce({_:2},[ue(Object.keys(e.$slots),f=>({name:f,fn:b(M=>[_(e.$slots,f,de(pe(M||{})))])}))]),1040,["onOk","onCancel"])]),key:"2"},ue(Object.keys(e.omit(e.$slots,"default")),f=>({name:f,fn:b(M=>[_(e.$slots,f,de(pe(M||{})))])}))]),1040,["onCancel"])}const Pt=V(Bt,[["render",wt]]),A=oe({}),te=oe({});function Xt(){const e=h(null),n=h(!1),s=h(0);function r(t,o){if(!X())throw new Error("useModal() can only be used inside setup() or functional components!");s.value=o,ve(()=>{e.value=null,n.value=!1,A[String(a(s))]=null}),!(a(n)&&he()&&t===a(e))&&(e.value=t,n.value=!0,t.emitOpen=(d,u)=>{te[u]=d})}const l=()=>{const t=a(e);return t||ye("useModal instance is undefined!"),t},i={setModalProps:t=>{var o;(o=l())==null||o.setModalProps(t)},getOpen:H(()=>te[~~a(s)]),redoModalHeight:()=>{var t,o;(o=(t=l())==null?void 0:t.redoModalHeight)==null||o.call(t)},openModal:(t=!0,o,d=!0)=>{var f;if((f=l())==null||f.setModalProps({open:t}),!o)return;const u=a(s);if(d){A[u]=null,A[u]=Y(o);return}tt(Y(A[u]),Y(o))||(A[u]=Y(o))},closeModal:()=>{var t;(t=l())==null||t.setModalProps({open:!1})}};return[r,i]}const Kt=e=>{const n=h(null),s=X(),r=h(0),l=()=>{const t=a(n);return t||ye("useModalInner instance is undefined!"),t},i=(t,o)=>{me(()=>{n.value=null}),r.value=o,n.value=t,s==null||s.emit("register",t,o)};return K(()=>{const t=A[a(r)];t&&(!e||!q(e)||W(()=>{e(t)}))}),[i,{changeLoading:(t=!0)=>{var o;(o=l())==null||o.setModalProps({loading:t})},getOpen:H(()=>te[~~a(r)]),changeOkLoading:(t=!0)=>{var o;(o=l())==null||o.setModalProps({confirmLoading:t})},closeModal:()=>{var t;(t=l())==null||t.setModalProps({open:!1})},setModalProps:t=>{var o;(o=l())==null||o.setModalProps(t)},redoModalHeight:()=>{var o;const t=(o=l())==null?void 0:o.redoModalHeight;t&&t()}}]},Dt=Ce(Pt);function Tt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Me(e)}const Et={useCollapse:{type:Boolean,default:!0},title:{type:String,default:""},size:{type:String,validator:e=>["small","default","middle",void 0].includes(e),default:"small"},bordered:{type:Boolean,default:!0},column:{type:[Number,Object],default:()=>({xxl:4,xl:3,lg:3,md:3,sm:2,xs:1})},collapseOptions:{type:Object,default:null},schema:{type:Array,default:()=>[]},data:{type:Object}},Rt=E({name:"Description",props:Et,emits:["register"],setup(e,{slots:n,emit:s}){const r=h(null),{prefixCls:l}=le("description"),i=He(),t=H(()=>m(m({},e),a(r))),o=H(()=>N(m({},a(t)),{title:void 0})),d=H(()=>!!a(t).title),u=H(()=>m({canExpand:!1},a(o).collapseOptions)),p=H(()=>m(m({},a(i)),a(o)));function f(g){r.value=m(m({},a(r)),g)}function M({label:g,labelMinWidth:$,labelStyle:C}){if(!C&&!$)return g;const S=N(m({},C),{minWidth:`${$}px `});return y("div",{style:S},[g])}function B(){const{schema:g,data:$}=a(o);return a(g).map(C=>{const{render:S,field:P,span:j,show:c,contentMinWidth:v}=C;if(c&&q(c)&&!c($))return null;const I=()=>{var se;const R=(se=a(o))==null?void 0:se.data;if(!R)return null;const z=nt(R,P);return z&&!be(R).hasOwnProperty(P)?q(S)?S("",R):"":q(S)?S(z,R):z!=null?z:""},G=v;return y(fe.Item,{label:M(C),key:P,span:j},{default:()=>{if(!v)return I();const R={minWidth:`${G}px`};return y("div",{style:R},[I()])}})}).filter(C=>!!C)}const O=()=>{let g;return y(fe,L({class:`${l}`},a(p)),Tt(g=B())?g:{default:()=>[g]})},w=()=>{const g=e.useCollapse?O():y("div",null,[O()]);if(!e.useCollapse)return g;const{canExpand:$,helpMessage:C}=a(u),{title:S}=a(t);return y(Ze,{title:S,canExpan:$,helpMessage:C},{default:()=>g,action:()=>Ye(n,"action")})};return s("register",{setDescProps:f}),()=>a(d)?w():O()}});function Nt(e){if(!X())throw new Error("useDescription() can only be used inside setup() or functional components!");const n=h(null),s=h(!1);function r(i){a(s)&&he()||(n.value=i,e&&i.setDescProps(e),s.value=!0)}return[r,{setDescProps:i=>{var t;(t=a(n))==null||t.setDescProps(i)}}]}const Wt=Ce(Rt),Ut=E({__name:"DetailModal",props:{info:{type:Object,default:null}},setup(e){const{t:n}=ne(),[s]=Nt({column:2,schema:ot()});return(r,l)=>(k(),T(a(Dt),L({width:800,title:a(n)("sys.errorLog.tableActionDesc")},r.$attrs),{default:b(()=>[y(a(Wt),{data:e.info,onRegister:a(s)},null,8,["data","onRegister"])]),_:1},16,["title"]))}});export{Dt as B,Ut as _,Vt as a,Kt as b,Xt as c,it as d,He as u};
